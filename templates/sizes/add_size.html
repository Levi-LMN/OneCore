{% extends "base.html" %}

{% block title %}Add Size - Liquor Store Management{% endblock %}

{% block page_title %}Add Size{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-8 col-lg-6">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h5 class="mb-0">
                    <i class="fas fa-plus-circle me-2"></i>Add New Size
                </h5>
                <a href="{{ url_for('sizes') }}" class="btn btn-outline-secondary btn-sm">
                    <i class="fas fa-arrow-left me-1"></i>Back to Sizes
                </a>
            </div>
            <div class="card-body">
                <form method="POST" id="addSizeForm">
                    <div class="mb-3">
                        <label for="name" class="form-label">Size Name <span class="text-danger">*</span></label>
                        <input type="text" class="form-control" id="name" name="name" required 
                               placeholder="e.g., 750ml, 330ml, Tot (30ml)" maxlength="20">
                        <div class="form-text">Enter a unique size name (max 20 characters)</div>
                    </div>

                    <div class="mb-3">
                        <label for="description" class="form-label">Description</label>
                        <textarea class="form-control" id="description" name="description" rows="2" 
                                  placeholder="Optional description of this size" maxlength="100"></textarea>
                        <div class="form-text">Brief description of this size (max 100 characters)</div>
                    </div>

                    <div class="mb-3">
                        <label for="sort_order" class="form-label">Sort Order</label>
                        <input type="number" class="form-control" id="sort_order" name="sort_order" 
                               value="0" min="0" max="999">
                        <div class="form-text">Order for display (0 = first, higher numbers appear later)</div>
                    </div>

                    <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                        <a href="{{ url_for('sizes') }}" class="btn btn-secondary">
                            <i class="fas fa-times me-1"></i>Cancel
                        </a>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save me-1"></i>Add Size
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Help Card -->
        <div class="card mt-3">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="fas fa-info-circle me-2"></i>Size Guidelines
                </h6>
            </div>
            <div class="card-body">
                <ul class="mb-0">
                    <li><strong>Be specific:</strong> Include measurement units in the name (ml, L, cl)</li>
                    <li><strong>Use common terms:</strong> "Tot (30ml)" is more recognizable than just "30ml"</li>
                    <li><strong>Sort order:</strong> Arrange from smallest to largest for better user experience</li>
                    <li><strong>Consider variants:</strong> Sizes are used to create product variants with different prices</li>
                </ul>
            </div>
        </div>
    </div>

    <div class="col-md-4 col-lg-6">
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="fas fa-ruler me-2"></i>Common Size Examples
                </h6>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-sm-6">
                        <h6 class="text-primary">Spirits & Liqueurs</h6>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-shot-glass me-1 text-warning"></i>Tot (30ml)</li>
                            <li><i class="fas fa-wine-bottle me-1 text-info"></i>250ml</li>
                            <li><i class="fas fa-wine-bottle me-1 text-success"></i>750ml</li>
                            <li><i class="fas fa-wine-bottle me-1 text-primary"></i>1L</li>
                        </ul>
                        
                        <h6 class="text-primary mt-3">Beer & Beverages</h6>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-beer me-1 text-warning"></i>330ml</li>
                            <li><i class="fas fa-beer me-1 text-success"></i>500ml</li>
                            <li><i class="fas fa-wine-glass me-1 text-danger"></i>Can</li>
                        </ul>
                    </div>
                    <div class="col-sm-6">
                        <h6 class="text-primary">Wine</h6>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-wine-glass me-1 text-danger"></i>750ml</li>
                            <li><i class="fas fa-wine-glass me-1 text-primary"></i>1.5L (Magnum)</li>
                        </ul>
                        
                        <h6 class="text-primary mt-3">Bulk/Draft</h6>
                        <ul class="list-unstyled">
                            <li><i class="fas fa-keg me-1 text-warning"></i>Keg/Draft</li>
                            <li><i class="fas fa-tint me-1 text-info"></i>Bulk</li>
                        </ul>
                        
                        <h6 class="text-primary mt-3">Suggested Sort Order</h6>
                        <small class="text-muted">
                            1. Tot (30ml)<br>
                            2. 250ml<br>
                            3. 330ml<br>
                            4. 500ml<br>
                            5. 750ml<br>
                            6. 1L<br>
                            7. 1.5L<br>
                            8. Can<br>
                            9. Keg/Draft
                        </small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Form validation
document.getElementById('addSizeForm').addEventListener('submit', function(e) {
    const name = document.getElementById('name').value.trim();
    const sortOrder = parseInt(document.getElementById('sort_order').value);
    
    if (!name) {
        e.preventDefault();
        alert('Please enter a size name.');
        document.getElementById('name').focus();
        return false;
    }
    
    if (name.length > 20) {
        e.preventDefault();
        alert('Size name must be 20 characters or less.');
        document.getElementById('name').focus();
        return false;
    }
    
    if (isNaN(sortOrder) || sortOrder < 0 || sortOrder > 999) {
        e.preventDefault();
        alert('Sort order must be a number between 0 and 999.');
        document.getElementById('sort_order').focus();
        return false;
    }
});

// Auto-capitalize first letter and format
document.getElementById('name').addEventListener('input', function() {
    let value = this.value;
    if (value.length > 0) {
        // Capitalize first letter
        value = value.charAt(0).toUpperCase() + value.slice(1);
        this.value = value;
    }
});

// Suggest sort order based on common sizes
document.getElementById('name').addEventListener('change', function() {
    const name = this.value.toLowerCase();
    const sortOrderField = document.getElementById('sort_order');
    
    // Only suggest if field is empty or 0
    if (parseInt(sortOrderField.value) === 0) {
        const sizeOrderMap = {
            'tot': 1,
            '30ml': 1,
            '250ml': 2,
            '330ml': 3,
            '500ml': 4,
            '750ml': 5,
            '1l': 6,
            '1.5l': 7,
            'magnum': 7,
            'can': 8,
            'keg': 9,
            'draft': 9,
            'bulk': 10
        };
        
        for (const [key, order] of Object.entries(sizeOrderMap)) {
            if (name.includes(key)) {
                sortOrderField.value = order;
                break;
            }
        }
    }
});
</script>
{% endblock %}